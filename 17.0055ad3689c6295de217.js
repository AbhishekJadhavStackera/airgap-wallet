(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{VPfA:function(i,t,n){"use strict";n.r(t),n.d(t,"AccountImportLedgerOnboardingPageModule",function(){return I});var o=n("ofXK"),e=n("3Pt+"),c=n("tyNb"),s=n("TEn/"),r=n("sYmb"),a=n("j1ZV"),d=n("mrSG"),l=n("0pct"),b=n("1y+R"),g=n("z26V"),p=n("hPkG"),u=n("fXoL"),h=n("138U");const f=function(i){return{protocolName:i}};function m(i,t){if(1&i&&(u.Sb(0,"ion-title"),u.Ob(1,"span",13),u.dc(2,"translate"),u.Rb()),2&i){const i=u.cc();u.Cb(1),u.ic("innerHTML",u.fc(2,1,"account-import-ledger-onboarding.title",u.mc(4,f,i.protocol.name)),u.rc)}}function S(i,t){if(1&i&&(u.Ob(0,"p",14),u.dc(1,"translate")),2&i){const i=u.cc();u.ic("innerHTML",u.fc(1,1,"account-import-ledger-onboarding.text",u.mc(4,f,i.protocol.name)),u.rc)}}function v(i,t){1&i&&(u.Qb(0),u.Ob(1,"ion-spinner",2),u.Sb(2,"ion-label"),u.Sb(3,"h3"),u.yc(4),u.dc(5,"translate"),u.Rb(),u.Rb(),u.Pb()),2&i&&(u.Cb(4),u.zc(u.ec(5,1,"account-import-ledger-onboarding.status-card.connecting")))}function C(i,t){if(1&i&&(u.Qb(0),u.Ob(1,"ion-icon",15),u.Sb(2,"ion-label",16),u.Sb(3,"h3"),u.yc(4),u.dc(5,"translate"),u.Rb(),u.Sb(6,"p"),u.yc(7),u.dc(8,"translate"),u.Rb(),u.Rb(),u.Pb()),2&i){const i=u.cc();u.Cb(4),u.Ac(" ",u.ec(5,2,"account-import-ledger-onboarding.status-card.error.header")," "),u.Cb(3),u.zc(u.fc(8,4,"account-import-ledger-onboarding.status-card.error.message",u.mc(7,f,i.protocol.name)))}}function w(i,t){1&i&&(u.Qb(0),u.Ob(1,"ion-icon",17),u.Sb(2,"ion-label",16),u.Sb(3,"h3"),u.yc(4),u.dc(5,"translate"),u.Rb(),u.Rb(),u.Pb()),2&i&&(u.Cb(4),u.zc(u.ec(5,1,"account-import-ledger-onboarding.status-card.success")))}function O(i,t){if(1&i){const i=u.Tb();u.Qb(0),u.Sb(1,"ion-button",18),u.ac("click",function(){return u.qc(i),u.cc().retry()}),u.yc(2),u.dc(3,"translate"),u.Rb(),u.Pb()}2&i&&(u.Cb(2),u.Ac(" ",u.ec(3,1,"account-import-ledger-onboarding.status-card.retry_button")," "))}function R(i,t){if(1&i&&(u.Sb(0,"ion-slide",20),u.Sb(1,"div",21),u.Ob(2,"img",22),u.Sb(3,"ion-text"),u.Ob(4,"p",23),u.dc(5,"translate"),u.Rb(),u.Rb(),u.Rb()),2&i){const i=t.$implicit,n=u.cc(2);u.Cb(2),u.ic("src","./assets/img/"+i[0],u.sc),u.Cb(2),u.ic("innerHTML",u.fc(5,2,i[1],u.mc(5,f,n.protocol.name)),u.rc)}}function y(i,t){if(1&i&&(u.Qb(0),u.wc(1,R,6,7,"ion-slide",19),u.Pb()),2&i){const i=u.cc();u.Cb(1),u.ic("ngForOf",i.slideAssets)}}function P(i,t){if(1&i){const i=u.Tb();u.Sb(0,"ion-button",18),u.ac("click",function(){return u.qc(i),u.cc().showPrevSlide()}),u.Ob(1,"ion-icon",24),u.yc(2),u.dc(3,"translate"),u.Rb()}2&i&&(u.Cb(2),u.Ac(" ",u.ec(3,1,"account-import-ledger-onboarding.back_button")," "))}function x(i,t){if(1&i){const i=u.Tb();u.Sb(0,"ion-button",18),u.ac("click",function(){return u.qc(i),u.cc().finish()}),u.yc(1),u.dc(2,"translate"),u.Rb()}2&i&&(u.Cb(1),u.Ac(" ",u.ec(2,1,"account-import-ledger-onboarding.done_button")," "))}function L(i,t){if(1&i){const i=u.Tb();u.Sb(0,"ion-button",18),u.ac("click",function(){return u.qc(i),u.cc().showNextSlide()}),u.yc(1),u.dc(2,"translate"),u.Ob(3,"ion-icon",25),u.Rb()}2&i&&(u.Cb(1),u.Ac(" ",u.ec(2,1,"account-import-ledger-onboarding.next_button")," "))}let N=(()=>{class i{constructor(i,t,n,o,e){this.route=i,this.router=t,this.protocolService=n,this.dataService=o,this.ledgerService=e,this.slideAssets=[],this.slideOpts={initialSlide:0,speed:400,pagination:{el:".swiper-pagination",type:"custom",renderCustom:(i,t,n)=>this.customProgressBar(t,n)}},this.canSlidePrev=!1,this.canSlideNext=!0,this.canFinish=!1,this.isLoading=!0,this.isSuccess=void 0,this.isConnected=!1,this.init()}showPrevSlide(){return Object(d.a)(this,void 0,void 0,function*(){yield this.slides.slidePrev()})}showNextSlide(){return Object(d.a)(this,void 0,void 0,function*(){yield this.slides.slideNext()})}ionSlideDidChange(){this.slides.getActiveIndex().then(i=>{const t=i===this.slideAssets.length-1;this.canSlidePrev=i>0,this.canSlideNext=!t,this.canFinish=t,this.importFromLedger()}).catch(Object(p.b)(p.a.OTHER))}retry(){this.isLoading=!0,this.isSuccess=void 0,this.importFromLedger()}finish(){this.router.navigateByUrl("/tabs/portfolio",{replaceUrl:!0}).catch(Object(p.b)(p.a.NAVIGATION))}customProgressBar(i,t){let n="<div class='swiper-pagination-progressbar' style='height: 4px; top: 6px; width: calc(100% - 32px);left: 16px;'>";return n+="<span class='swiper-pagination-progressbar-fill' style='transform: translate3d(0px, 0px, 0px) scaleX("+i/t+") scaleY(1); transition-duration: 300ms;'></span>",n+="</span></div>",n}init(){return Object(d.a)(this,void 0,void 0,function*(){const i=this.route.snapshot.params.protocolID;this.protocol=yield this.protocolService.getProtocol(i),this.slideAssets=[["ledger_app_connected.svg","account-import-ledger-onboarding.slides.slide-1"],[`ledger_app_${this.protocol.identifier}.svg`,"account-import-ledger-onboarding.slides.slide-2"],["ledger_app_confirm.svg","account-import-ledger-onboarding.slides.slide-3"]],this.importFromLedger()})}importFromLedger(){return Object(d.a)(this,void 0,void 0,function*(){if(!this.isSuccess&&this.protocol)return this.importPromise||(this.importPromise=Object(l.a)(this.connectWithLedger(),{maxRetries:4,interval:300}).then(()=>Object(l.a)(this.ledgerService.importWallet(this.protocol.identifier).then(i=>{this.isLoading=!1,this.isSuccess=!0,this.dataService.setData(b.b.SYNC_ACCOUNTS,[{wallet:i}]),this.router.navigateByUrl(`/account-import/${b.b.SYNC_ACCOUNTS}`).catch(Object(p.b)(p.a.NAVIGATION))}),{maxRetries:1,interval:300})).catch(i=>{console.warn(i),this.canFinish&&(this.isLoading=!1,this.isSuccess=!1)}).finally(()=>{this.importPromise=void 0})),this.importPromise})}connectWithLedger(){return Object(d.a)(this,void 0,void 0,function*(){if(!this.isConnected&&this.protocol)return this.isLoading=!0,this.ledgerService.openConnection(this.protocol.identifier).then(()=>{this.isConnected=!0})})}}return i.\u0275fac=function(t){return new(t||i)(u.Nb(c.a),u.Nb(c.g),u.Nb(h.x),u.Nb(b.a),u.Nb(g.a))},i.\u0275cmp=u.Hb({type:i,selectors:[["page-account-import-ledger-onboarding"]],viewQuery:function(i,t){if(1&i&&u.Ec(s.Y,3),2&i){let i;u.oc(i=u.bc())&&(t.slides=i.first)}},decls:26,vars:11,consts:[[1,"ion-no-border"],["fixed","true",1,"ion-no-padding"],["slot","start"],["defaultHref","/"],[4,"ngIf"],["class","ion-padding-horizontal",3,"innerHTML",4,"ngIf"],[1,"ion-margin"],["lines","none",1,"ion-no-padding"],["pager","true",3,"options","ionSlideDidChange"],["slides",""],[1,"ion-no-padding"],["slot","end"],["fill","clear","color","primary",3,"click",4,"ngIf"],[3,"innerHTML"],[1,"ion-padding-horizontal",3,"innerHTML"],["name","alert-circle-outline","slot","start","size","large","color","warning"],[1,"ion-text-wrap"],["name","checkmark-circle-outline","slot","start","size","large","color","success"],["fill","clear","color","primary",3,"click"],["class","ion-padding-horizontal",4,"ngFor","ngForOf"],[1,"ion-padding-horizontal"],[1,"slide-zoom"],[3,"src"],[1,"ion-text-left",3,"innerHTML"],["name","arrow-back"],["name","arrow-forward"]],template:function(i,t){1&i&&(u.Sb(0,"ion-header",0),u.Sb(1,"ion-grid",1),u.Sb(2,"ion-toolbar"),u.Sb(3,"ion-buttons",2),u.Ob(4,"ion-back-button",3),u.Rb(),u.wc(5,m,3,6,"ion-title",4),u.Rb(),u.Rb(),u.Rb(),u.Sb(6,"ion-content"),u.Sb(7,"ion-grid",1),u.wc(8,S,2,6,"p",5),u.Sb(9,"ion-card",6),u.Sb(10,"ion-card-content"),u.Sb(11,"ion-item",7),u.wc(12,v,6,3,"ng-container",4),u.wc(13,C,9,9,"ng-container",4),u.wc(14,w,6,3,"ng-container",4),u.Rb(),u.wc(15,O,4,3,"ng-container",4),u.Rb(),u.Rb(),u.Sb(16,"ion-slides",8,9),u.ac("ionSlideDidChange",function(){return t.ionSlideDidChange()}),u.wc(18,y,2,1,"ng-container",4),u.Rb(),u.Rb(),u.Rb(),u.Sb(19,"ion-footer",0),u.Sb(20,"ion-grid",1),u.Sb(21,"ion-toolbar",10),u.Sb(22,"ion-buttons",11),u.wc(23,P,4,3,"ion-button",12),u.wc(24,x,3,3,"ion-button",12),u.wc(25,L,4,3,"ion-button",12),u.Rb(),u.Rb(),u.Rb(),u.Rb()),2&i&&(u.Cb(5),u.ic("ngIf",t.protocol),u.Cb(3),u.ic("ngIf",t.protocol),u.Cb(4),u.ic("ngIf",t.isLoading),u.Cb(1),u.ic("ngIf",t.protocol&&!t.isLoading&&void 0!==t.isSuccess&&!t.isSuccess),u.Cb(1),u.ic("ngIf",!t.isLoading&&t.isSuccess),u.Cb(1),u.ic("ngIf",!t.isLoading&&void 0!==t.isSuccess&&!t.isSuccess),u.Cb(1),u.ic("options",t.slideOpts),u.Cb(2),u.ic("ngIf",t.protocol),u.Cb(5),u.ic("ngIf",t.canSlidePrev),u.Cb(1),u.ic("ngIf",t.canFinish),u.Cb(1),u.ic("ngIf",t.canSlideNext))},directives:[s.v,s.u,s.ib,s.j,s.f,s.g,o.o,s.q,s.k,s.l,s.A,s.Y,s.t,s.gb,s.Z,s.D,s.w,s.i,o.n,s.X,s.eb],pipes:[r.c],styles:["ion-slides[_ngcontent-%COMP%]{height:calc(100% - 72px)}@media (min-width:768px){ion-slides[_ngcontent-%COMP%]   .swiper-slide[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20vw}}.swiper-slide[_ngcontent-%COMP%]{font-size:1rem}.slide-zoom[_ngcontent-%COMP%]{height:100%;padding:64px 0 0}"]}),i})(),I=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=u.Lb({type:i}),i.\u0275inj=u.Kb({imports:[[s.jb,o.c,e.e,a.a,r.b,c.j.forChild([{path:"",component:N}])]]}),i})()}}]);