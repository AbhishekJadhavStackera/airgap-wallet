(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{Q4oi:function(t,o,i){"use strict";i.r(o),i.d(o,"SubAccountImportPageModule",function(){return T});var e=i("ofXK"),n=i("3Pt+"),r=i("tyNb"),c=i("TEn/"),s=i("sYmb"),a=i("j1ZV"),l=i("mrSG"),b=i("138U"),u=i("RKiA"),d=i("lJxs"),p=i("1y+R"),h=i("QMTT"),f=i("57MG"),m=i("hPkG"),g=i("fXoL"),P=i("F07p"),v=i("1Mpf");function I(t,o){if(1&t){const t=g.Tb();g.Sb(0,"ion-list",11),g.Sb(1,"portfolio-item",12),g.ac("click",function(){g.qc(t);const i=o.$implicit;return g.cc(2).importWallet(i[0],i[1])}),g.Rb(),g.Rb()}if(2&t){const t=o.$implicit;g.Cb(1),g.ic("wallet",t[1])}}const w=function(t){return{tokenName:t}};function W(t,o){if(1&t&&(g.Ob(0,"empty-state",13),g.dc(1,"translate")),2&t){const t=g.cc(2);g.ic("text",g.fc(1,2,"sub-account-import.empty_text",g.mc(5,w,t.subProtocol.name)))("imageName","no-imports.svg")}}const y=function(t){return{subProtocolName:t}},R=function(t){return{typeLabel:t}};function O(t,o){if(1&t){const t=g.Tb();g.Sb(0,"ion-grid",1),g.Ob(1,"p",5),g.dc(2,"translate"),g.wc(3,I,2,1,"ion-list",6),g.wc(4,W,2,7,"empty-state",7),g.Sb(5,"ion-fab",8),g.Sb(6,"ion-button",9),g.ac("click",function(){return g.qc(t),g.cc().importWallets()}),g.Ob(7,"ion-icon",10),g.yc(8),g.dc(9,"translate"),g.dc(10,"translate"),g.Rb(),g.Rb(),g.Rb()}if(2&t){const t=g.cc();g.Cb(1),g.ic("innerHTML",g.fc(2,5,"sub-account-import.text",g.mc(13,y,t.subProtocol.name)),g.rc),g.Cb(2),g.ic("ngForOf",t.subWalletsWithGroups),g.Cb(1),g.ic("ngIf",0===t.subWalletsWithGroups.length),g.Cb(2),g.ic("disabled",0===t.subWalletsWithGroups.length),g.Cb(2),g.Ac(" ",g.fc(9,8,"sub-account-import.import-all_label",g.mc(15,R,g.ec(10,11,t.typeLabel)))," ")}}let S=(()=>{class t{constructor(t,o,i,e,n,r){let c;this.router=t,this.route=o,this.accountProvider=i,this.priceService=e,this.protocolService=n,this.typeLabel="",this.subWalletsWithGroups=[],c=r.getData(p.b.PROTOCOL),void 0!==c?(this.subProtocolIdentifier=c.subProtocolIdentifier,this.networkIdentifier=c.networkIdentifier,this.protocolService.getProtocol(this.subProtocolIdentifier,this.networkIdentifier).then(t=>{this.subProtocol=t})):(this.subProtocolIdentifier=this.route.snapshot.params.protocolID,this.networkIdentifier=this.route.snapshot.params.networkID,this.protocolService.getProtocol(this.subProtocolIdentifier,this.networkIdentifier).then(t=>{this.subProtocol=t})),this.accountProvider.wallets$.pipe(Object(d.a)(t=>t.filter(t=>t.status===u.AirGapWalletStatus.ACTIVE&&t.protocol.identifier===Object(b.J)(this.subProtocolIdentifier)&&t.protocol.options.network.type===u.NetworkType.MAINNET))).subscribe(t=>{const o=t.map(t=>Object(l.a)(this,void 0,void 0,function*(){if(!this.accountProvider.walletByPublicKeyAndProtocolAndAddressIndex(t.publicKey,this.subProtocolIdentifier)){const o=yield this.protocolService.getProtocol(this.subProtocolIdentifier),i=this.accountProvider.findWalletGroup(t),e=new u.AirGapMarketWallet(o,t.publicKey,t.isExtendedPublicKey,t.derivationPath,t.masterFingerprint,t.status,this.priceService);return e.addresses=t.addresses,this.subWalletsWithGroups.push([i,e]),e.synchronize()}}));Promise.all(o).then(()=>this.accountProvider.triggerWalletChanged()).catch(Object(m.b)(m.a.COINLIB))})}importWallets(){const t=this.subWalletsWithGroups.map(([t,o])=>({walletToAdd:o,groupId:void 0!==t?t.id:void 0,groupLabel:void 0!==t?t.label:void 0}));this.accountProvider.addWallets(t).catch(Object(m.b)(m.a.WALLET_PROVIDER)),this.popToRoot()}importWallet(t,o){this.accountProvider.addWallets([{walletToAdd:o,groupId:void 0!==t?t.id:void 0,groupLabel:void 0!==t?t.label:void 0}]).catch(Object(m.b)(m.a.WALLET_PROVIDER)),this.popToRoot()}popToRoot(){this.router.navigateByUrl("/tabs/portfolio").catch(Object(m.b)(m.a.NAVIGATION))}}return t.\u0275fac=function(o){return new(o||t)(g.Nb(r.g),g.Nb(r.a),g.Nb(f.a),g.Nb(h.a),g.Nb(b.x),g.Nb(p.a))},t.\u0275cmp=g.Hb({type:t,selectors:[["page-sub-account-import"]],decls:10,vars:4,consts:[[1,"ion-no-border"],["fixed","true",1,"ion-no-padding"],["slot","start"],["defaultHref","/"],["fixed","true","class","ion-no-padding",4,"ngIf"],[1,"ion-padding-horizontal",3,"innerHTML"],["lines","none","class","ion-margin-top",4,"ngFor","ngForOf"],[3,"text","imageName",4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed"],["shape","round","color","secondary",3,"disabled","click"],["slot","start","name","add"],["lines","none",1,"ion-margin-top"],["tappable","",3,"wallet","click"],[3,"text","imageName"]],template:function(t,o){1&t&&(g.Sb(0,"ion-header",0),g.Sb(1,"ion-grid",1),g.Sb(2,"ion-toolbar"),g.Sb(3,"ion-buttons",2),g.Ob(4,"ion-back-button",3),g.Rb(),g.Sb(5,"ion-title"),g.yc(6),g.dc(7,"translate"),g.Rb(),g.Rb(),g.Rb(),g.Rb(),g.Sb(8,"ion-content"),g.wc(9,O,11,17,"ion-grid",4),g.Rb()),2&t&&(g.Cb(6),g.zc(g.ec(7,2,"sub-account-import.title")),g.Cb(3),g.ic("ngIf",o.subProtocol))},directives:[c.v,c.u,c.ib,c.j,c.f,c.g,c.gb,c.q,e.o,e.n,c.r,c.i,c.w,c.E,P.a,v.a],pipes:[s.c],encapsulation:2}),t})(),T=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=g.Lb({type:t}),t.\u0275inj=g.Kb({imports:[[c.jb,e.c,n.e,a.a,s.b,r.j.forChild([{path:"",component:S}])]]}),t})()}}]);