(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{SY1b:function(e,t,i){"use strict";i.r(t),i.d(t,"DelegationDetailPageModule",function(){return De});var n=i("ofXK"),o=i("3Pt+"),c=i("TEn/"),a=i("138U"),l=i("tyNb"),s=i("sYmb"),r=i("QUrN"),d=i("j1ZV"),b=i("iTUp"),g=i("mrSG"),u=i("RKiA"),p=i("2Vo4"),h=i("fXoL");const f=function(e){return{delegateeLabel:e}};function w(e,t){if(1&e){const e=h.Tb();h.Sb(0,"ion-item",3),h.ac("click",function(){return h.qc(e),h.cc().changeDelegateeToAirGap()}),h.Ob(1,"ion-icon",4),h.yc(2),h.dc(3,"translate"),h.dc(4,"translate"),h.Rb()}if(2&e){const e=h.cc();h.Cb(2),h.Ac(" ",h.fc(3,1,"delegate-action-popover.change-to-airgap-delegatee_label",h.mc(6,f,h.ec(4,4,e.delegateeLabel)))," ")}}function m(e,t){if(1&e){const e=h.Tb();h.Sb(0,"ion-item",3),h.ac("click",function(){h.qc(e);const i=t.$implicit;return h.cc().callSecondaryAction(i.type)}),h.Ob(1,"ion-icon",5),h.yc(2),h.dc(3,"translate"),h.Rb()}if(2&e){const e=t.$implicit;h.Cb(1),h.ic("name",e.iconName||"send-outline"),h.Cb(1),h.Ac(" ",h.ec(3,2,e.confirmLabel||e.label)," ")}}const y=function(){return[]};let S=(()=>{class e{constructor(e,t){this.popoverController=e,this.navParams=t;const i=this.navParams.get("hideAirGap"),n=this.navParams.get("delegateeLabel"),o=this.navParams.get("secondaryDelegatorActions");this.hideAirGap=void 0===i||i,this.delegateeLabel=void 0!==n?n:"delegation-detail.default-delegatee-label",this.secondaryDelegatorActions=void 0!==o?o:[]}changeDelegateeToAirGap(){this.popoverController.dismiss({changeToAirGap:!0})}callSecondaryAction(e){this.popoverController.dismiss({secondaryActionType:e})}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(c.rb),h.Nb(c.ob))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-delegate-action-popover"]],decls:7,vars:6,consts:[["lines","none","no-detail","",1,"ion-no-padding","ion-no-margin"],["button","","detail","false",3,"click",4,"ngIf"],["button","","detail","false",3,"click",4,"ngFor","ngForOf"],["button","","detail","false",3,"click"],["name","swap-vertical-outline","color","dark","slot","end"],["color","dark","slot","end",3,"name"]],template:function(e,t){1&e&&(h.Sb(0,"ion-list",0),h.Sb(1,"ion-list-header"),h.Sb(2,"ion-label"),h.yc(3),h.dc(4,"translate"),h.Rb(),h.Rb(),h.wc(5,w,5,8,"ion-item",1),h.wc(6,m,4,4,"ion-item",2),h.Rb()),2&e&&(h.Cb(3),h.zc(h.ec(4,3,"delegate-action-popover.delegation-settings_label")),h.Cb(2),h.ic("ngIf",!t.hideAirGap),h.Cb(1),h.ic("ngForOf",t.secondaryDelegatorActions||h.lc(5,y)))},directives:[c.E,c.F,c.D,n.o,n.n,c.A,c.w],pipes:[s.c],styles:[""]}),e})();var D=i("VE8E"),v=i("ZBbp"),R=i("tZEG"),A=i("1y+R"),C=i("Xl7a"),O=i("nxqh"),I=i("hPkG"),x=i("oCjk"),k=i("57MG"),$=i("0CrI"),F=i("cwVp");function L(e,t){if(1&e&&(h.Sb(0,"ion-button",5),h.ac("click",function(){return t.$implicit.action()}),h.yc(1),h.dc(2,"translate"),h.Rb()),2&e){const e=t.$implicit;h.Cb(1),h.Ac(" ",h.ec(2,1,e.text)," ")}}function P(e,t){if(1&e&&(h.Sb(0,"div"),h.wc(1,L,3,3,"ion-button",4),h.Rb()),2&e){const e=h.cc();h.Cb(1),h.ic("ngForOf",e.widget.actions)}}i("CZvy");let N=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Hb({type:e,selectors:[["widget-alert"]],inputs:{widget:"widget"},decls:11,vars:10,consts:[["lines","none",1,"ion-margin-vertical",3,"detail","color","click"],["slot","start","color","dark",3,"name"],["color","dark",1,"ion-text-wrap"],[4,"ngIf"],["color","light",3,"click",4,"ngFor","ngForOf"],["color","light",3,"click"]],template:function(e,t){1&e&&(h.Sb(0,"ion-item",0),h.ac("click",function(){return t.widget.onClick?t.widget.onClick():void 0}),h.Ob(1,"ion-icon",1),h.Sb(2,"ion-label",2),h.Sb(3,"h3"),h.Sb(4,"strong"),h.yc(5),h.dc(6,"translate"),h.Rb(),h.Rb(),h.Sb(7,"p"),h.yc(8),h.dc(9,"translate"),h.Rb(),h.wc(10,P,2,1,"div",3),h.Rb(),h.Rb()),2&e&&(h.ic("detail",t.widget.detail)("color",t.widget.color),h.Cb(1),h.ic("name",t.widget.icon),h.Cb(4),h.zc(h.ec(6,6,t.widget.title)),h.Cb(3),h.zc(h.ec(9,8,t.widget.description)),h.Cb(2),h.ic("ngIf",t.widget.actions))},directives:[c.A,c.w,c.D,n.o,n.n,c.i],pipes:[s.c],styles:[""]}),e})();var T=i("sXsg");function j(e,t){if(1&e&&(h.Sb(0,"ion-row",1),h.Sb(1,"ion-col",2),h.yc(2),h.Rb(),h.Sb(3,"ion-col"),h.yc(4),h.Rb(),h.Sb(5,"ion-col"),h.yc(6),h.dc(7,"date"),h.Rb(),h.Rb()),2&e){const e=t.$implicit;h.Cb(2),h.zc(e.index),h.Cb(2),h.zc(e.amount),h.Cb(2),h.zc(h.fc(7,3,e.timestamp,"dd.LL.yy"))}}i("76Ou");let G=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Hb({type:e,selectors:[["widget-reward-list"]],inputs:{widget:"widget"},decls:15,vars:10,consts:[[1,"ion-padding"],[1,"ion-justify-content-center","ion-padding-bottom"],["size","2"],["class","ion-justify-content-center ion-padding-bottom",4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(h.Sb(0,"ion-card",0),h.Sb(1,"ion-row",1),h.Sb(2,"ion-col",2),h.Sb(3,"strong"),h.yc(4),h.dc(5,"translate"),h.Rb(),h.Rb(),h.Sb(6,"ion-col"),h.Sb(7,"strong"),h.yc(8),h.dc(9,"translate"),h.Rb(),h.Rb(),h.Sb(10,"ion-col"),h.Sb(11,"strong"),h.yc(12),h.dc(13,"translate"),h.Rb(),h.Rb(),h.Rb(),h.wc(14,j,8,6,"ion-row",3),h.Rb()),2&e&&(h.Cb(4),h.zc(h.ec(5,4,t.widget.indexColLabel)),h.Cb(4),h.zc(h.ec(9,6,t.widget.amountColLabel)),h.Cb(4),h.zc(h.ec(13,8,t.widget.payoutColLabel)),h.Cb(2),h.ic("ngForOf",t.widget.rewards))},directives:[c.k,c.Q,c.p,n.n],pipes:[s.c,n.e],styles:[""]}),e})();function E(e,t){if(1&e){const e=h.Tb();h.Sb(0,"ion-button",30),h.ac("click",function(t){return h.qc(e),h.cc().presentEditPopover(t)}),h.Ob(1,"ion-icon",31),h.Rb()}}function z(e,t){if(1&e&&h.Ob(0,"widget-account",32),2&e){const e=h.cc();h.ic("widget",e.delegateeAccountWidget)}}function M(e,t){1&e&&(h.Sb(0,"div"),h.Sb(1,"ion-item",33),h.Sb(2,"ion-avatar",2),h.Ob(3,"ion-skeleton-text",34),h.Rb(),h.Sb(4,"ion-label"),h.Sb(5,"h2"),h.Ob(6,"ion-skeleton-text",35),h.Rb(),h.Sb(7,"p"),h.Ob(8,"ion-skeleton-text",36),h.Rb(),h.Rb(),h.Rb(),h.Rb())}const _=function(e){return{delegateeLabel:e}};function B(e,t){if(1&e){const e=h.Tb();h.Sb(0,"ion-row",37),h.Sb(1,"ion-col",12),h.Sb(2,"ion-button",38),h.ac("click",function(){return h.qc(e),h.cc().showDelegateesList()}),h.Ob(3,"ion-icon",39),h.yc(4),h.dc(5,"translate"),h.dc(6,"translate"),h.Rb(),h.Rb(),h.Rb()}if(2&e){const e=h.cc();h.Cb(4),h.Ac(" ",h.fc(5,1,"delegation-detail.change-delegatee_label",h.mc(6,_,h.ec(6,4,e.delegateeLabel)))," ")}}function V(e,t){if(1&e&&(h.Sb(0,"span"),h.yc(1),h.dc(2,"number"),h.dc(3,"async"),h.Rb()),2&e){const e=h.cc(2);h.Cb(1),h.Ac(" ",h.fc(2,1,100*h.ec(3,4,e.delegateeDetails$).usageDetails.usage.toNumber(),"1.2-2"),"% ")}}function Q(e,t){if(1&e&&(h.Sb(0,"small"),h.wc(1,V,4,6,"span",23),h.dc(2,"async"),h.Rb()),2&e){const e=h.cc();h.Cb(1),h.ic("ngIf",h.ec(2,1,e.delegateeDetails$).usageDetails)}}function W(e,t){1&e&&(h.Sb(0,"div"),h.Sb(1,"p",40),h.Ob(2,"ion-skeleton-text",41),h.Rb(),h.Rb())}const q=function(e){return{protocol:e,maxDigits:3}};function U(e,t){if(1&e&&(h.Sb(0,"span"),h.yc(1),h.dc(2,"async"),h.dc(3,"amountConverter"),h.dc(4,"async"),h.dc(5,"async"),h.dc(6,"amountConverter"),h.dc(7,"async"),h.Rb()),2&e){const e=h.cc(2);h.Cb(1),h.Bc(" ",h.ec(2,2,h.fc(3,4,h.ec(4,7,e.delegateeDetails$).usageDetails.current.toFixed(),h.mc(16,q,e.wallet.protocol)))," / ",h.ec(5,9,h.fc(6,11,h.ec(7,14,e.delegateeDetails$).usageDetails.total.toFixed(),h.mc(18,q,e.wallet.protocol)))," ")}}function H(e,t){if(1&e&&(h.Sb(0,"small"),h.wc(1,U,8,20,"span",23),h.dc(2,"async"),h.Rb()),2&e){const e=h.cc();h.Cb(1),h.ic("ngIf",h.ec(2,1,e.delegateeDetails$).usageDetails)}}function K(e,t){1&e&&(h.Sb(0,"div",42),h.Ob(1,"ion-skeleton-text",41),h.Rb())}function X(e,t){if(1&e&&(h.Qb(0),h.Sb(1,"ion-item",44),h.Ob(2,"widget-selector",32),h.Rb(),h.Pb()),2&e){const e=t.$implicit;h.Cb(2),h.ic("widget",e)}}function Z(e,t){if(1&e&&(h.Sb(0,"ion-card"),h.wc(1,X,3,1,"ng-container",43),h.dc(2,"async"),h.Rb()),2&e){const e=h.cc(2);h.Cb(1),h.ic("ngForOf",e.filterVisible(h.ec(2,1,e.delegateeDetails$).displayDetails))}}function J(e,t){if(1&e&&(h.Qb(0),h.wc(1,Z,3,3,"ion-card",23),h.dc(2,"async"),h.Pb()),2&e){const e=h.cc();h.Cb(1),h.ic("ngIf",h.ec(2,1,e.delegateeDetails$).displayDetails)}}function Y(e,t){1&e&&(h.Sb(0,"ion-card"),h.Sb(1,"ion-item",44),h.Sb(2,"ion-avatar",2),h.Ob(3,"ion-skeleton-text",34),h.Rb(),h.Sb(4,"ion-label"),h.Sb(5,"h2"),h.Ob(6,"ion-skeleton-text",45),h.Rb(),h.Sb(7,"h3"),h.Ob(8,"ion-skeleton-text",46),h.Rb(),h.Rb(),h.Rb(),h.Rb())}function ee(e,t){1&e&&h.Ob(0,"widget-alert",32),2&e&&h.ic("widget",t.$implicit)}function te(e,t){if(1&e&&(h.Sb(0,"ion-row",6),h.Sb(1,"ion-col",7),h.wc(2,ee,1,1,"widget-alert",47),h.Rb(),h.Rb()),2&e){const e=h.cc();h.Cb(2),h.ic("ngForOf",e.delegationAlertWidgets)}}function ie(e,t){if(1&e&&(h.Sb(0,"ion-segment-button",52),h.Sb(1,"ion-label"),h.yc(2),h.dc(3,"translate"),h.Rb(),h.Rb()),2&e){const e=t.$implicit;h.ic("value",e.type),h.Cb(2),h.zc(h.ec(3,2,e.label))}}const ne=function(){return[]};function oe(e,t){if(1&e){const e=h.Tb();h.Sb(0,"ion-segment",50),h.ac("ngModelChange",function(t){return h.qc(e),h.cc(2).activeDelegatorAction=t})("ionChange",function(){h.qc(e);const t=h.cc(2);return t.onActiveActionChange(t.activeDelegatorAction)}),h.wc(1,ie,4,4,"ion-segment-button",51),h.dc(2,"async"),h.Rb()}if(2&e){const e=h.cc(2);h.ic("ngModel",e.activeDelegatorAction),h.Cb(1),h.ic("ngForOf",h.ec(2,2,e.delegatorDetails$).mainActions||h.lc(4,ne))}}function ce(e,t){if(1&e&&(h.Sb(0,"ion-row",6),h.Sb(1,"ion-col",7),h.Ob(2,"p",53),h.dc(3,"translate"),h.Rb(),h.Rb()),2&e){const e=h.cc(2).$implicit;h.Cb(2),h.ic("innerHtml",h.ec(3,1,e.description),h.rc)}}function ae(e,t){if(1&e&&(h.Sb(0,"form",56),h.Ob(1,"widget-selector",57),h.Rb()),2&e){const e=h.cc().$implicit,t=h.cc(2).$implicit,i=h.cc(2);h.ic("formGroup",i.delegationForms.get(t.type)),h.Cb(1),h.ic("widget",e)("widgetForm",i.delegationForms.get(t.type))}}function le(e,t){if(1&e&&h.Ob(0,"widget-selector",32),2&e){const e=h.cc().$implicit;h.ic("widget",e)}}function se(e,t){if(1&e&&(h.Sb(0,"ion-row"),h.Sb(1,"ion-col",7),h.wc(2,ae,2,3,"form",54),h.wc(3,le,1,1,"widget-selector",55),h.Rb(),h.Rb()),2&e){const e=h.cc(2).$implicit,t=h.cc(2);h.Cb(2),h.ic("ngIf",t.delegationForms.get(e.type)),h.Cb(1),h.ic("ngIf",!t.delegationForms.get(e.type))}}function re(e,t){if(1&e&&(h.Qb(0),h.wc(1,ce,4,3,"ion-row",22),h.wc(2,se,4,2,"ion-row",43),h.Pb()),2&e){const e=h.cc().$implicit,t=h.cc(2);h.Cb(1),h.ic("ngIf",e.description),h.Cb(1),h.ic("ngForOf",t.filterVisible(e.args))}}function de(e,t){if(1&e&&(h.Qb(0),h.wc(1,re,3,2,"ng-container",23),h.Pb()),2&e){const e=t.$implicit,i=h.cc(2);h.Cb(1),h.ic("ngIf",i.activeDelegatorAction===e.type.toString())}}const be=function(e){return{"segment--container":e}};function ge(e,t){if(1&e&&(h.Sb(0,"ion-row"),h.Sb(1,"ion-col",7),h.wc(2,oe,3,5,"ion-segment",48),h.Sb(3,"div",49),h.wc(4,de,2,1,"ng-container",43),h.dc(5,"async"),h.Rb(),h.Rb(),h.Rb()),2&e){const e=h.cc();h.Cb(2),h.ic("ngIf",e.shouldDisplaySegmentButtons),h.Cb(1),h.ic("ngClass",h.mc(5,be,e.shouldDisplaySegmentButtons)),h.Cb(1),h.ic("ngForOf",h.ec(5,3,e.delegatorDetails$).mainActions||h.lc(7,ne))}}function ue(e,t){if(1&e&&(h.Sb(0,"ion-item",44),h.Ob(1,"widget-icon-text",32),h.Rb()),2&e){const e=h.cc(2);h.Cb(1),h.ic("widget",e.delegatorBalanceWidget)}}function pe(e,t){if(1&e&&(h.Qb(0),h.Sb(1,"ion-item",44),h.Ob(2,"widget-selector",32),h.Rb(),h.Pb()),2&e){const e=t.$implicit;h.Cb(2),h.ic("widget",e)}}function he(e,t){if(1&e&&(h.Qb(0),h.wc(1,ue,2,1,"ion-item",58),h.wc(2,pe,3,1,"ng-container",43),h.dc(3,"async"),h.Pb()),2&e){const e=h.cc();h.Cb(1),h.ic("ngIf",e.delegatorBalanceWidget),h.Cb(1),h.ic("ngForOf",e.filterVisible(h.ec(3,2,e.delegatorDetails$).displayDetails))}}function fe(e,t){1&e&&(h.Sb(0,"ion-item",44),h.Sb(1,"ion-avatar",2),h.Ob(2,"ion-skeleton-text",34),h.Rb(),h.Sb(3,"ion-label"),h.Sb(4,"h2"),h.Ob(5,"ion-skeleton-text",45),h.Rb(),h.Sb(6,"h3"),h.Ob(7,"ion-skeleton-text",46),h.Rb(),h.Rb(),h.Rb())}function we(e,t){if(1&e&&(h.Qb(0),h.Sb(1,"ion-row",6),h.Sb(2,"ion-text",24),h.Sb(3,"p",59),h.yc(4),h.dc(5,"translate"),h.Rb(),h.Rb(),h.Rb(),h.Sb(6,"ion-row"),h.Sb(7,"ion-col",7),h.Ob(8,"widget-reward-list",32),h.dc(9,"async"),h.Rb(),h.Rb(),h.Pb()),2&e){const e=h.cc();h.Cb(4),h.Ac(" ",h.ec(5,2,"delegation-detail.your-rewards_label")," "),h.Cb(4),h.ic("widget",h.ec(9,4,e.rewardDisplay$))}}function me(e,t){1&e&&(h.Qb(0),h.Sb(1,"ion-card"),h.Sb(2,"ion-item",44),h.Sb(3,"ion-label"),h.Sb(4,"h2"),h.Ob(5,"ion-skeleton-text",60),h.Rb(),h.Sb(6,"h3"),h.Ob(7,"ion-skeleton-text",34),h.Rb(),h.Sb(8,"h3"),h.Ob(9,"ion-skeleton-text",34),h.Rb(),h.Sb(10,"h3"),h.Ob(11,"ion-skeleton-text",34),h.Rb(),h.Rb(),h.Rb(),h.Rb(),h.Pb())}function ye(e,t){if(1&e&&h.wc(0,me,12,0,"ng-container",23),2&e){const e=h.cc();h.ic("ngIf",void 0===e.hasRewardDetails)}}let Se=(()=>{class e{constructor(e,t,i,n,o,c,a,l,s,r,d,b){this.router=e,this.navController=t,this.dataService=i,this.operations=n,this.extensionsService=o,this.loadingController=c,this.popoverController=a,this.toastController=l,this.route=s,this.formBuilder=r,this.amountConverter=d,this.accountProvider=b,this.delegationForms=new Map,this.activeDelegatorAction=null,this.activeDelegatorActionConfirmButton=null,this.delegateeDetails$=new p.a(null),this.delegatorDetails$=new p.a(null),this.rewardDisplay$=new p.a(null),this.canProceed=!0,this.hasRewardDetails=void 0,this.delegateeAddress$=new p.a(null),this.areMultipleDelegationsSupported=!1}get shouldDisplaySegmentButtons(){const e=this.delegatorDetails$.value;return e.mainActions&&e.mainActions.some(e=>!!e.description||!!e.args)}get isAirGapDelegatee(){return!!Object(D.a)(this.wallet.protocol)&&this.wallet.protocol.airGapDelegatee()&&this.delegateeAddress$.value===this.wallet.protocol.airGapDelegatee()}get hideAirGapOverflow(){return Object(D.a)(this.wallet.protocol)&&!this.wallet.protocol.airGapDelegatee()||this.isAirGapDelegatee}ngOnInit(){this.publicKey=this.route.snapshot.params.publicKey,this.protocolID=this.route.snapshot.params.protocolID,this.addressIndex=this.route.snapshot.params.addressIndex,this.addressIndex="undefined"===this.addressIndex?void 0:Number(this.addressIndex),this.wallet=this.accountProvider.walletByPublicKeyAndProtocolAndAddressIndex(this.publicKey,this.protocolID,this.addressIndex),this.extensionsService.loadDelegationExtensions().then(()=>{this.initView()})}filterVisible(e){return e?e.filter(e=>e.isVisible):[]}presentEditPopover(e){return Object(g.a)(this,void 0,void 0,function*(){const t=this.delegatorDetails$.value,i=t?t.secondaryActions:void 0,n=yield this.popoverController.create({component:S,componentProps:{hideAirGap:this.hideAirGapOverflow,delegateeLabel:this.delegateeLabel,secondaryDelegatorActions:i},event:e,translucent:!0});return n.onDidDismiss().then(({data:e})=>Object(g.a)(this,void 0,void 0,function*(){Object(x.b)(e,"changeToAirGap")&&Object(D.a)(this.wallet.protocol)?this.changeDisplayedDetails(this.wallet.protocol.airGapDelegatee()):Object(x.b)(e,"secondaryActionType")?this.callSecondaryAction(e.secondaryActionType):console.log("Unknown option selected.")})).catch(Object(I.b)(I.a.IONIC_ALERT)),n.present().catch(Object(I.b)(I.a.NAVIGATION))})}callMainAction(e){const t=this.delegatorDetails$.value;t&&(t.mainActions&&0!==t.mainActions.length?this.callAction(t.mainActions,e):this.navController.back())}callSecondaryAction(e){const t=this.delegatorDetails$.value;t&&this.callAction(t.secondaryActions||[],e)}onActiveActionChange(e){const t=this.delegatorDetails$.value.mainActions?this.delegatorDetails$.value.mainActions.find(t=>t.type.toString()===e):null;this.activeDelegatorAction=e,this.activeDelegatorActionConfirmButton=t&&!t.disabled?t.confirmLabel||t.label:null}showDelegateesList(){this.dataService.setData(A.b.DETAIL,{wallet:this.wallet,delegateeLabel:this.delegateeLabel,delegateeLabelPlural:this.delegateeLabelPlural,areMultipleDelegationsSupported:this.areMultipleDelegationsSupported,currentDelegatees:this.delegatorDetails$.value.delegatees,callback:e=>{this.changeDisplayedDetails(e)}}),this.router.navigateByUrl("/delegation-list/"+A.b.DETAIL,{skipLocationChange:!0}).catch(Object(I.b)(I.a.NAVIGATION))}initView(){this.delegateeLabel=Object(D.a)(this.wallet.protocol)?this.wallet.protocol.delegateeLabel:"delegation-detail.default-delegatee-label",this.delegateeLabelPlural=Object(D.a)(this.wallet.protocol)?this.wallet.protocol.delegateeLabelPlural:"delegation-detail.defailt-delegatee-label-plural",this.areMultipleDelegationsSupported=!!Object(D.a)(this.wallet.protocol)&&this.wallet.protocol.supportsMultipleDelegations,this.subscribeObservables(),this.operations.getCurrentDelegatees(this.wallet).then(e=>{e&&this.delegateeAddress$.next(e[0])})}subscribeObservables(){this.delegateeAddress$.subscribe(e=>Object(g.a)(this,void 0,void 0,function*(){e&&(this.updateDisplayedDetails(null),this.updateDisplayedRewards(null),this.operations.getDelegationDetails(this.wallet,[e]).then(e=>{e&&e.length>0&&this.updateDisplayedDetails(e)}),this.operations.getRewardDisplayDetails(this.wallet,[e]).then(e=>{this.hasRewardDetails=void 0!==e,e&&this.updateDisplayedRewards(e)}))})),this.delegateeDetails$.subscribe(e=>{this.delegateeAccountWidget=e?new v.a({name:e.name,address:e.address,logo:e.logo,shortenAddress:!0}):null}),this.delegatorDetails$.subscribe(e=>Object(g.a)(this,void 0,void 0,function*(){this.showOverflowMenu=!(this.isAirGapDelegatee||this.hideAirGapOverflow)||e&&e.secondaryActions&&e.secondaryActions.length>0,e&&(this.delegatorBalanceWidget=new R.a({iconName:"wallet-outline",text:yield this.amountConverter.transform(e.balance,{protocol:this.wallet.protocol,maxDigits:this.wallet.protocol.decimals}),description:"delegation-detail.your-balance_label"}),this.setupAllActions(e),this.setupFormObservers(),this.initActiveDelegatorAction(e))}))}setupAllActions(e){this.setupActions(e.mainActions||[]),this.setupActions(e.secondaryActions||[])}setupActions(e){e.forEach(e=>{this.setupFormForAction(e),e.form=this.delegationForms.get(e.type),e.args&&e.args.forEach(e=>{e.wallet=this.wallet})})}setupFormForAction(e){e.form&&this.delegationForms.set(e.type,e.form);const t=this.delegationForms.get(e.type),i={};e.args&&e.args.forEach(e=>{i[e.id]=t?t.value[e.id]:null}),t?Object.keys(i).map(e=>[e,i[e]]).forEach(([e,i])=>t.addControl(e,i)):this.delegationForms.set(e.type,this.formBuilder.group(i))}setupFormObservers(){Array.from(this.delegationForms.entries()).forEach(([e,t])=>{t.valueChanges.subscribe(()=>{this.activeDelegatorAction===e.toString()&&setTimeout(()=>{this.canProceed=t.valid})})})}initActiveDelegatorAction(e){const t=e.mainActions?e.mainActions[0]:null;this.onActiveActionChange(t?t.type.toString():null)}updateDisplayedDetails(e){this.delegationAlertWidgets=e?e[0].alerts:void 0,this.delegateeDetails$.next(e?e[0].delegatees[0]:null),this.delegatorDetails$.next(e?e[0].delegator:null)}updateDisplayedRewards(e){this.rewardDisplay$.next(e)}changeDisplayedDetails(e){this.delegateeAddress$.next(e)}callAction(e,t){const i=e.find(e=>e.type.toString()===t),n=i?i.type:void 0;i.disabled?this.navController.back():n?this.prepareDelegationAction(n):console.warn("Unknown action")}prepareDelegationAction(e){return Object(g.a)(this,void 0,void 0,function*(){this.loader=yield this.loadingController.create({message:"Preparing transaction..."}),yield this.loader.present().catch(Object(I.b)(I.a.IONIC_LOADER));try{const t=this.delegationForms.get(e),i=t?t.value:void 0,{airGapTxs:n,unsignedTx:o}=yield this.operations.prepareDelegatorAction(this.wallet,e,i),c={wallet:this.wallet,airGapTxs:n,data:o,type:u.IACMessageType.TransactionSignRequest};this.dismissLoader(),this.dataService.setData(A.b.INTERACTION,c),this.router.navigateByUrl("/interaction-selection/"+A.b.INTERACTION,{skipLocationChange:!0}).catch(Object(I.b)(I.a.NAVIGATION))}catch(t){this.dismissLoader(),console.warn(t),this.showToast(t.message)}})}dismissLoader(){this.loader&&this.loader.dismiss().catch(Object(I.b)(I.a.IONIC_LOADER))}showToast(e){return Object(g.a)(this,void 0,void 0,function*(){(yield this.toastController.create({message:e,duration:3e3,position:"bottom"})).present().catch(Object(I.b)(I.a.IONIC_TOAST))})}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(l.g),h.Nb(c.nb),h.Nb(A.a),h.Nb(O.a),h.Nb(C.a),h.Nb(c.lb),h.Nb(c.rb),h.Nb(c.wb),h.Nb(l.a),h.Nb(o.b),h.Nb(a.g),h.Nb(k.a))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-delegation-detail"]],decls:73,vars:56,consts:[[1,"ion-no-border"],["fixed","true",1,"ion-no-padding"],["slot","start"],["defaultHref","/"],["slot","end"],["color","secondary",3,"click",4,"ngIf"],[1,"ion-padding-horizontal"],["size","12"],[3,"widget",4,"ngIf","ngIfElse"],["delegateeAvatarSkeleton",""],["class","ion-padding-horizontal action--container",4,"ngIf"],[1,"ion-padding-horizontal","ion-padding-bottom"],["size","12",1,"ion-no-padding"],[1,"progress--container"],[1,"progress--current"],["size","6",1,"ion-no-padding"],[4,"ngIf","ngIfElse"],["delegateeUsageSkeleton",""],["size","6",1,"ion-no-padding","ion-text-right"],["delegateeUsageDetailsSkeleton",""],[1,"ion-padding-bottom"],["delegateeExtraSkeleton",""],["class","ion-padding-horizontal",4,"ngIf"],[4,"ngIf"],["color","primary"],[1,"font--weight__bold","ion-no-margin","ion-ion-text"],["delegatorDetailsSkeleton",""],["rewardsSkeleton",""],["vertical","bottom","horizontal","end","slot","fixed"],["shape","round","color","primary",3,"disabled","click"],["color","secondary",3,"click"],["name","ellipsis-vertical-outline"],[3,"widget"],["lines","none",1,"ion-no-padding"],["animated",""],["animated","",2,"width","40%","height","19px"],["animated","",2,"width","80%"],[1,"ion-padding-horizontal","action--container"],["color","secondary","shape","round","size","small","fill","outline",3,"click"],["slot","start","name","swap-vertical-outline"],[1,"ion-no-margin"],["animated","",2,"width","50%"],[1,"justify--content__end"],[4,"ngFor","ngForOf"],["lines","none"],["animated","",2,"width","80%","height","19px"],["animated","",2,"width","40%"],[3,"widget",4,"ngFor","ngForOf"],["scrollable","true","class","ion-padding-horizontal",3,"ngModel","ngModelChange","ionChange",4,"ngIf"],[3,"ngClass"],["scrollable","true",1,"ion-padding-horizontal",3,"ngModel","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[3,"innerHtml"],[3,"formGroup",4,"ngIf"],[3,"widget",4,"ngIf"],[3,"formGroup"],[3,"widget","widgetForm"],["lines","none",4,"ngIf"],["ion-text","",1,"font--weight__bold","ion-no-margin"],["animated","",2,"width","100%","height","19px"]],template:function(e,t){if(1&e&&(h.Sb(0,"ion-header",0),h.Sb(1,"ion-grid",1),h.Sb(2,"ion-toolbar"),h.Sb(3,"ion-buttons",2),h.Ob(4,"ion-back-button",3),h.Rb(),h.Sb(5,"ion-title"),h.yc(6),h.dc(7,"translate"),h.dc(8,"translate"),h.Rb(),h.Sb(9,"ion-buttons",4),h.wc(10,E,2,0,"ion-button",5),h.Rb(),h.Rb(),h.Rb(),h.Rb(),h.Sb(11,"ion-content"),h.Sb(12,"ion-grid",1),h.Sb(13,"ion-row",6),h.Sb(14,"ion-col",7),h.wc(15,z,1,1,"widget-account",8),h.wc(16,M,9,0,"ng-template",null,9,h.xc),h.Rb(),h.Rb(),h.wc(18,B,7,8,"ion-row",10),h.dc(19,"async"),h.Sb(20,"ion-row",11),h.Sb(21,"ion-col",12),h.Sb(22,"p"),h.yc(23),h.dc(24,"titlecase"),h.dc(25,"translate"),h.dc(26,"async"),h.Rb(),h.Rb(),h.Sb(27,"ion-col",12),h.Sb(28,"div",13),h.Ob(29,"div",14),h.dc(30,"async"),h.Rb(),h.Rb(),h.Sb(31,"ion-col",12),h.Sb(32,"ion-row"),h.Sb(33,"ion-col",15),h.wc(34,Q,3,3,"small",16),h.dc(35,"async"),h.wc(36,W,3,0,"ng-template",null,17,h.xc),h.Rb(),h.Sb(38,"ion-col",18),h.wc(39,H,3,3,"small",16),h.dc(40,"async"),h.wc(41,K,2,0,"ng-template",null,19,h.xc),h.Rb(),h.Rb(),h.Rb(),h.Rb(),h.Sb(43,"ion-row",20),h.Sb(44,"ion-col",7),h.wc(45,J,3,3,"ng-container",16),h.dc(46,"async"),h.wc(47,Y,9,0,"ng-template",null,21,h.xc),h.Rb(),h.Rb(),h.wc(49,te,3,1,"ion-row",22),h.wc(50,ge,6,8,"ion-row",23),h.dc(51,"async"),h.Sb(52,"ion-row",6),h.Sb(53,"ion-col",12),h.Sb(54,"ion-text",24),h.Sb(55,"p",25),h.yc(56),h.dc(57,"translate"),h.Rb(),h.Rb(),h.Rb(),h.Rb(),h.Sb(58,"ion-row",20),h.Sb(59,"ion-col",7),h.Sb(60,"ion-card"),h.wc(61,he,4,4,"ng-container",16),h.dc(62,"async"),h.wc(63,fe,8,0,"ng-template",null,26,h.xc),h.Rb(),h.Rb(),h.Rb(),h.wc(65,we,10,6,"ng-container",16),h.dc(66,"async"),h.wc(67,ye,1,1,"ng-template",null,27,h.xc),h.Rb(),h.Sb(69,"ion-fab",28),h.Sb(70,"ion-button",29),h.ac("click",function(){return t.callMainAction(t.activeDelegatorAction)}),h.yc(71),h.dc(72,"translate"),h.Rb(),h.Rb(),h.Rb()),2&e){const e=h.pc(17),i=h.pc(37),n=h.pc(42),o=h.pc(48),c=h.pc(64),a=h.pc(68);let l=null,s=null;h.Cb(6),h.zc(h.fc(7,23,"delegation-detail.title",h.mc(54,_,h.ec(8,26,t.delegateeLabel)))),h.Cb(4),h.ic("ngIf",t.showOverflowMenu),h.Cb(5),h.ic("ngIf",t.delegateeAccountWidget)("ngIfElse",e),h.Cb(3),h.ic("ngIf",h.ec(19,28,t.delegateeDetails$)),h.Cb(5),h.zc(h.ec(24,30,h.ec(25,32,null==(l=h.ec(26,34,t.delegateeDetails$))?null:l.status))),h.Cb(6),h.vc("width",(100*(null==(s=h.ec(30,36,t.delegateeDetails$))||null==s.usageDetails?null:s.usageDetails.usage.toNumber())).toFixed(2)+"%"),h.Cb(5),h.ic("ngIf",h.ec(35,38,t.delegateeDetails$))("ngIfElse",i),h.Cb(5),h.ic("ngIf",h.ec(40,40,t.delegateeDetails$))("ngIfElse",n),h.Cb(6),h.ic("ngIf",h.ec(46,42,t.delegateeDetails$))("ngIfElse",o),h.Cb(4),h.ic("ngIf",t.delegationAlertWidgets),h.Cb(1),h.ic("ngIf",h.ec(51,44,t.delegatorDetails$)),h.Cb(6),h.Ac(" ",h.ec(57,46,"delegation-detail.your-delegation_label")," "),h.Cb(5),h.ic("ngIf",h.ec(62,48,t.delegatorDetails$))("ngIfElse",c),h.Cb(4),h.ic("ngIf",h.ec(66,50,t.rewardDisplay$))("ngIfElse",a),h.Cb(5),h.ic("disabled",!t.canProceed),h.Cb(1),h.Ac(" ",h.ec(72,52,t.activeDelegatorActionConfirmButton||"delegation-detail.done_button")," ")}},directives:[c.v,c.u,c.ib,c.j,c.f,c.g,c.gb,n.o,c.q,c.Q,c.p,c.eb,c.k,c.r,c.i,c.w,$.a,c.A,c.e,c.W,c.D,n.n,F.a,N,n.m,c.S,c.ub,o.h,o.j,c.T,o.n,o.i,o.d,T.a,G],pipes:[s.c,n.b,n.s,n.f,a.g],styles:[".progress--container[_ngcontent-%COMP%]{width:100%;height:4px;background-color:#00e8cc1f}.progress--current[_ngcontent-%COMP%]{height:inherit;background-color:var(--ion-color-primary)}.border--container[_ngcontent-%COMP%]{border:1px solid var(--ion-color-secondary);border-radius:50%}.segment--container[_ngcontent-%COMP%]{min-height:185px}ion-segment[_ngcontent-%COMP%]::-webkit-scrollbar{width:0;height:0;display:none}ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]{min-width:-moz-fit-content;min-width:fit-content}.action--container[_ngcontent-%COMP%]{background:#fff}"]}),e})(),De=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.Lb({type:e}),e.\u0275inj=h.Kb({imports:[[n.c,o.e,o.k,c.jb,d.a,s.b,b.a,r.c,l.j.forChild([{path:"",component:Se}]),a.e]]}),e})()}}]);